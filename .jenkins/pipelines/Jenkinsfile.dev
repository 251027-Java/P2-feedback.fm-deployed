pipeline {
    agent any

    tools {
        jdk 'java25'
    }

    stages {
        stage('Info') {
            steps {
                publishChecks(name: 'Build Info', status: 'IN_PROGRESS', summary: 'running', title: 'A title')
                echo "Build tag: ${env.BUILD_TAG}"
                echo "Branch: ${GIT_BRANCH}"
                echo "Commit: ${GIT_COMMIT}"

                // for debugging. remove this later
                sh 'printenv | sort'
            }
            post {
                success {
                    // githubNotify(context: 'Build Info', description: 'Success', status: 'SUCCESS')
                    publishChecks(name: 'Build Info', status: 'COMPLETED', summary: 'Success', conclusion: 'SUCCESS', title: 'A title')
                }
                failure {
                    // githubNotify(context: 'Build Info', description: 'Failed', status: 'FAILURE', title: 'A title')
                    publishChecks(name: 'Build Info', status: 'COMPLETED', summary: 'Failed', conclusion: 'FAILURE', title: 'A title')
                }
            }
        }
    }
}
