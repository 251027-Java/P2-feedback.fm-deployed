services:
  jenkins:
    build: .
    volumes:
      - jenkins-data:/var/jenkins_home
    ports:
      - ${JENKINS_PORT}:8080
      - ${JENKINS_AGENT_PORT}:50000
    environment:
      JAVA_OPTS: -Djenkins.install.runSetupWizard=false
    secrets:
      - jenkins_username
      - jenkins_password
      - main_github_pat_username
      - main_github_pat_password
    restart: unless-stopped

volumes:
  jenkins-data:

secrets:
  jenkins_username:
    file: ./secrets/jenkins_username
  jenkins_password:
    file: ./secrets/jenkins_password
  main_github_pat_username:
    file: ./secrets/main_github_pat_username
  main_github_pat_password:
    file: ./secrets/main_github_pat_password
